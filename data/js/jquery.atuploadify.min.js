(function(a){a.extend(a.fn,{atUploadify:function(b){a(this).each(function(){function l(b,c){var d=a.inArray(b,c);if(d==-1){c.push(b)}return c}function m(b,c){var d=a.inArray(b,c);if(d==-1){c.push(b)}return c}var c={id:a(this).attr("id"),uploader:"",height:"80",width:"120",fileDesc:"Image Files(*.jpg,*.png) | All Files (*.*)",fileExt:"*.jpg;*.png; | *.*",fileType:"images",prevImage:"",fileSize:2097152,fileLimit:4,folder:"",uploadUrl:"uploadify.php",filenameUrl:"",wmode:"window",scriptAccess:"sameDomain",auto:true,editImgs:"",preview:"",status:"",expressInstall:"js/expressInstall.swf",cancelImage:"../images/Cancel.png",buttonImage:"../images/Browse.png",onSelect:function(){},onComplete:function(){},onRemove:function(){},onCancel:function(){}};var d=a.extend({},c,b);var e=a(this);var f={};var g=[];var h=0;var i=0;f.uploadifyID=d.id;f.uploadUrl=d.uploadUrl;f.filenameUrl=d.filenameUrl;f.buttonImage=d.buttonImage;f.folder=d.folder;f.width=d.width;f.height=d.height;f.fileDesc=d.fileDesc;f.fileExt=d.fileExt;var j=d.folder.split("/");var k="../"+j[j.length-2];if(d.uploader!=""){e.css("display","none");e.after('<div id="'+e.attr("id")+'upl" style="float:left;"></div>');var n=swfobject.getFlashPlayerVersion();if(n.major==0){alert("Please download flash player!!!")}swfobject.embedSWF(d.uploader,d.id+"upl",d.width,d.height,"9.0.24",d.expressInstall,f,{quality:"high",wmode:d.wmode,allowScriptAccess:d.scriptAccess},{},function(a){if(typeof d.onSWFReady=="function"&&a.success)d.onSWFReady()});a("#"+e.attr("id")+"upl").after('<div id="'+e.attr("id")+'upls"></div>');e.bind("custom",{action:d.onSelect,queueID:d.queueID},function(b,c,f){function m(){document.getElementById(e.attr("id")+"upl").cancelupload()}var j=Math.round(f/1024);var k=j>1023?Math.round(j/1024)+" MB":j+" KB";var l=Math.round(d.fileSize/1024)>1023?Math.round(d.fileSize/1024)+" MB":d.fileSize+" KB";if(d.fileLimit>1){h=parseFloat(f)}else{h=parseFloat(f)}i=g.length;if(i>=d.fileLimit&&d.fileLimit!=1){alert("You have exceeded the file limit!!!");return false}if(h>d.fileSize){alert("This file exceeds the "+l+" size limit");return false}a("#"+e.attr("id")+"upls").html(s(c+" "+k,d.cancelImage));a("#status").val(c+" "+k);a("[name=clstatusclose]").unbind("click");a("[name=clstatusclose]").click(function(){m();a(".clupstatus").remove()});if(d.auto){document.getElementById(a(this).attr("id")+"upl").clupload()}});e.bind("getStatus",{},function(b,c){a(".clupstatusmsg").html(c)});e.bind("uploadCancel",{action:d.onCancel},function(a,b,c){h=0;a.data.action(a,b,c)});e.bind("uploadComplete",{action:d.onComplete},function(b,c,f){a(".clupstatusmsg").html(c);if(d.preview!=""){var h=a("#"+d.preview+"").css("height");var i=a("#"+d.preview+"").css("width");if(d.fileType=="images"){elm='<div style="float:left;" name="clprevhold"><img style="float:left;" src="'+d.folder+"/"+c+'" height="'+h+'"  width="'+i+'"/>'}else{elm='<div style="float:left;" name="clprevhold"><img style="float:left;" src="'+d.prevImage+'" height="'+h+'"  width="'+i+'"/>'}elm+='<img name="clprevclose" style="margin-left:-18px;z-index:100;cursor:pointer;display:none;" src="'+d.cancelImage+'" /></div>';if(d.fileLimit>1){a("#"+d.preview+"").append(elm)}else{a("#"+d.preview+"").html(elm)}o()}else{if(d.preview!="none"){var j=t(k+"/"+c,c,d.cancelImage);if(d.fileType!="images"){j=t(d.prevImage,c,d.cancelImage)}if(d.fileLimit>1){a("#"+e.attr("id")+"upls").after(j)}else{a("#"+e.attr("id")+"upls").next().remove();a("#"+e.attr("id")+"upls").after(j)}}a("[name=clstatusprevclose]").off("click").on("click",function(){q(a(this).parent().parent())})}a(".clupstatus").animate({opacity:0},3e3,function(){a(this).remove()});if(d.fileLimit==1){g[0]=c}else{g=l(c,g)}b.data.action(b,c,g)});e.bind("getProgress",function(b,c){a("#status").val(c);a(".clupstatusprogressbar").css({width:c+"%"})});function o(){a("[name=clprevhold]").hover(function(){a(this).find("[name=clprevclose]").show()},function(){a(this).find("[name=clprevclose]").hide()});a("[name=clprevclose]").off("click").on("click",function(){q(a(this).parent().find("img"))})}e.bind("deleteImg",function(a,b){h=0;g=p(b,g);e.trigger("removeImg",[g])});e.bind("removeImg",{action:d.onRemove},function(a,b){a.data.action(a,b)});function p(b,c){var e=a.inArray(b,c);a.post(d.uploadUrl,{d:b,folder:d.folder},function(a){},"json");if(e!=-1){c.splice(e,1)}return c}function q(a){var b=confirm("Are You Sure ?");if(b){var c=a.find(".clupfilename").html();a.remove();var d=c.substring(c.lastIndexOf("/")+1);g=p(c,g);e.trigger("removeImg",[g])}}function r(a,b){var c='<div class="clupstatus">';c+='<div class="clupstatusheader">';c+='<a name="clstatusclose"><img src="'+b+'" /></a>';c+="</div>";c+='<div class="clupalertmsg">'+a+"</div>";c+="</div>";return c}function s(a,b){var c='<div class="clupstatus">';c+='<div class="clupstatusheader">';c+='<a name="clstatusclose"><img src="'+b+'" /></a>';c+="</div>";c+='<div class="clupstatusmsg">'+a+"</div>";c+='<div class="clupstatusprogress"><div class="clupstatusprogressbar" style="height:99%;width:0%;background:#000;"></div></div>';c+="</div>";return c}function t(a,b,c){if(d.fileType!="images"){a=d.prevImage}var e='<div class="cluppreview">';e+='<div class="cluppreviewheader">';e+='<a name="clstatusprevclose"><img src="'+c+'" /></a>';e+="</div>";e+='<div class="cluppreviewimg">';e+='<img src="'+a+'" />';e+='<div class="clupfilename">';e+=b;e+="</div>";e+="</div>";e+="</div>";return e}if(d.editImgs!=""){var u=a("#"+d.editImgs+"").val();u=u!=""?u.split(","):"";if(u.length>0){a.each(u,function(b,c){g=l(c,g);var f=t(k+"/"+c,c,d.cancelImage);if(d.fileType!="images"){f=t(d.prevImage,c,d.cancelImage)}a("#"+e.attr("id")+"upls").after(f)});a("[name=clstatusprevclose]").off("click").on("click",function(){q(a(this).parent().parent())})}}}})},clcustupload:function(){document.getElementById(a(this).attr("id")+"upl").clupload()}})})(jQuery)